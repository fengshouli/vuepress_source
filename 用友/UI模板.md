# UI模板-单据

ui模板可以直接与元数据对应,使开发简单的页面非常简单,只需配置即可.

## 通用.

### [bill_base]

单据的基本信息.

| 主键              | 单据编码                                                | 单据名称      | 单据类型          | 子产品id         | 类型                     |
| ----------------- | ------------------------------------------------------- | ------------- | ----------------- | ---------------- | ------------------------ |
| 唯一&nbsp; &nbsp; | 唯一的,一般由一串有含义的英文单词组成.代表了这个ui模板. | 单据名称,唯一 | list跳转card用的, | 对应元数据模块名 | 主要区分是list页还是card |

### [billentity_base]

单据实体基本信息.

| 单据id              | 实体编码      | 数据源名称       | label                                                   |
| ------------------- | ------------- | ---------------- | ------------------------------------------------------- |
| 对应bill_base的主键 | 同bill_base的 | 对应元数据的名称 | 自定义项在配置页显示与否.<br />如果配置了userdef,则显示 |

### [billtemplate_base]

| 单据id              | 模版名称          | 画布宽度       | 模板标题        |
| ------------------- | ----------------- | -------------- | --------------- |
| 对应bill_base的主键 | 随便起的名字,唯一 | 页面的展示宽度 | 模板的显示title |

### [billtplgroup_base]

单据分组.一般由前端人员布局时候配置.

### [billitem_base]

单据项.

| 单据ID | 单据实体ID                | 单据模板ID                  | 模板分组ID                            |
| ------ | ------------------------- | --------------------------- | ------------------------------------- |
| 唯一   | 对应billentity_base中的id | 对应billtemplate_base中的id | 对应billtplgroup_base中的某个分组的id |

| 字段名称   | 字段别名           | 标题       | 显示标题   | 排序     | 最大长度                        |
| ---------- | ------------------ | ---------- | ---------- | -------- | ------------------------------- |
| 字段的代码 | 一般和字段名称相同 | 显示的内容 | 显示的内容 | 显示顺序 | 一般100,<br />小了显示不出来了. |

| 是否枚举       | 枚举信息 | 是否可以删除 | 是否必选 | 是否隐藏             | 是否显示                                |
| -------------- | -------- | ------------ | -------- | -------------------- | --------------------------------------- |
| 1:是<br />0:否 | 没用     |              |          | 1:隐藏<br />0:不隐藏 | 与是否隐藏列对应<br />隐藏是0的,他就是1 |

| 参照类型                                                     |
| ------------------------------------------------------------ |
| 常用的去`pm-common-mdd-basedoc-repository/src/main/java/com/yonyou/pmcloud/mdd/repository/basedoc/constants/PMReferConsts.java`找,<br />还没有的去问问郭少刚该找谁要. |

| 参照返回信息                                                 | 小数位数       | 是否可修改     |
| ------------------------------------------------------------ | -------------- | -------------- |
| 根据配置的字段去查,查回来后给对应字段赋值.<br />例如:productCode上配置了{"productId":"id","productName":"name"}<br />查回来后会取结果中的id给productId赋值,取结果中的name给productName赋值. | 显示的小数位数 | 哪些字段可修改 |

| 是否过滤字段             | 格式化串设置                                                 | 是否可以为空                      | 是否自定义项目 |
| ------------------------ | ------------------------------------------------------------ | --------------------------------- | -------------- |
| 后台不处理,可以直接过滤. | 关联字段<br />一般就是{"related":"moneyDigit"},控制精度的,<br />注意,需要有一个字段名叫moneyDigit,并且格式化的字段,控制类型需要为Input,InputNumber会有默认的小数位数. | 导入功能必须的字段<br />0:否/1:是 | 是否自定义项   |

| 数据源名称       | 控制类型                                                     | 枚举类型                                  | 参照返回值                                                   | bVmExclude                                                   |
| ---------------- | ------------------------------------------------------------ | ----------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 对应数据源的名称 | Input:输入框<br />DatePicker:日期选择器<br />InputNumber:输入数字<br />Select:下拉选择框<br />Refer:参照 | 对应数据库中<br />aa_enum表的enumtype字段 | 选中后显示什么.<br />如果是code就展示代码,<br />name就展示名称 | 0:数据源对应字段,如果数据源没有,会报错<br />2:虚拟字段,可以不与数据源对应,需要自己处理. |

### [bill_toolbar]

工具栏

### [bill_toolbaritem]

工具栏中具体的项

| 名称             | 命令          | 类型                   | 标题     | 上级菜单                                           |
| ---------------- | ------------- | ---------------------- | -------- | -------------------------------------------------- |
| 同个ui模板唯一的 | 命令名称,唯一 | 按钮/下拉按钮/分隔栏等 | 显示标题 | 对应bill_toolbaritem的主键id,一般为下拉按钮的子级. |

### [bill_command]

命令配置表

| 名称                           | 动作                                | url                |
| ------------------------------ | ----------------------------------- | ------------------ |
| 对应bill_toolbaritem中命令字段 | 对应前端框架中某个操作,一般前端配置 | 触发命令后请求什么 |

| http方法                | 参数                                                         |
| ----------------------- | ------------------------------------------------------------ |
| 什么请求方式,GET/POST等 | 一些参数.{"billNum":"pgrm_project_task_import","refresh":false}<br />例如这个参数就是说,命令触发的是哪个bullNum,操作后列表不刷新. |

## list页.

卡片页需要注意的点

[bill_base]

| 类型                          |
| ----------------------------- |
| cBillType                     |
| VoucherList/ArchiveList(老的) |

其他:拥有过滤区,card页没有.[pb_meta_filters],[pb_meta_filter_item]

## card页.

[bill_base]

| 类型      |
| --------- |
| cBillType |
| Voucher   |

## 自动编码

[bill_base]中添加如下列.

| isCoded | cExtProps                |
| ------- | ------------------------ |
| isCoded | cExtProps                |
| 0       | {"isMultiCodeRule":true} |

## 导入.

导入必须是card页.

一般是其他的页面中配置下载模板按钮.配置的是导入的card页的billnum.

### [billitem_base] 

需要注意的列.

| 是否可以为空   | isExport               |
| -------------- | ---------------------- |
| 这个列必须有值 | 控制这个字段是否被导出 |



## 导出.

配一个导出按钮,配一个导出命令即可.

